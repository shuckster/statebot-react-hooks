{"version":3,"file":"statebot-react-hooks.js","sources":["../../src/index.js"],"sourcesContent":["import { useState, useEffect, useMemo } from 'react'\nimport { Statebot } from 'statebot'\n\n//\n// Use an existing Statebot\n//\nexport function useStatebot(bot) {\n  const [state, setState] = useState(bot.currentState())\n  useEffect(() => bot.onSwitched(setState), [bot])\n  return state\n}\n\n//\n// Create a new Statebot within a Component\n//\nexport function useStatebotFactory(name, config) {\n  const _config = useMemo(() => config, [name])\n  const listeners = []\n  useEffect(() => () => listeners.forEach(off => off()), [_config])\n\n  // We memoise Statebot since it's based on EventEmitter,\n  // so we create it once and add/remove listeners for\n  // the life-cycle of the component\n  const bot = useMemo(() => {\n    const { performTransitions, onTransitions, ...botConfig } = _config || {}\n    const bot = Statebot(name, botConfig)\n    listeners.push(\n      bot.performTransitions(performTransitions || {}),\n      bot.onTransitions(onTransitions || {})\n    )\n    return bot\n  }, [name, _config])\n\n  const state = useStatebot(bot)\n\n  return { state, bot }\n}\n\n//\n// Listen to Statebot events with automatic cleanup\n//\nexport function useStatebotEvent(bot, eventName, ...args) {\n  const listeners = []\n  useEffect(() => () => listeners.forEach(off => off()), [bot, eventName])\n  useEffect(() => {\n    if (\n      [\n        'onSwitching',\n        'onSwitched',\n        'onEntering',\n        'onEntered',\n        'onExiting',\n        'onExited'\n      ].includes(eventName)\n    ) {\n      listeners.push(bot[eventName](...args))\n    } else {\n      throw new Error(`Unknown event: ${eventName}`)\n    }\n  }, [bot, eventName])\n}\n"],"names":[],"mappings":";;;;;;;;;;;AAMO,SAAS,WAAW,CAAC,GAAG,EAAE;AACjC,EAAE,MAAM,CAAC,KAAK,EAAE,QAAQ,CAAC,GAAG,QAAQ,CAAC,GAAG,CAAC,YAAY,EAAE,EAAC;AACxD,EAAE,SAAS,CAAC,MAAM,GAAG,CAAC,UAAU,CAAC,QAAQ,CAAC,EAAE,CAAC,GAAG,CAAC,EAAC;AAClD,EAAE,OAAO,KAAK;AACd,CAAC;AAKM,SAAS,kBAAkB,CAAC,IAAI,EAAE,MAAM,EAAE;AACjD,EAAE,MAAM,OAAO,GAAG,OAAO,CAAC,MAAM,MAAM,EAAE,CAAC,IAAI,CAAC,EAAC;AAC/C,EAAE,MAAM,SAAS,GAAG,GAAE;AACtB,EAAE,SAAS,CAAC,MAAM,MAAM,SAAS,CAAC,OAAO,CAAC,GAAG,IAAI,GAAG,EAAE,CAAC,EAAE,CAAC,OAAO,CAAC,EAAC;AAKnE,EAAE,MAAM,GAAG,GAAG,OAAO,CAAC,MAAM;AAC5B,IAAI,MAAM,EAAE,kBAAkB,EAAE,aAAa,EAAE,GAAG,SAAS,EAAE,GAAG,OAAO,IAAI,GAAE;AAC7E,IAAI,MAAM,GAAG,GAAG,QAAQ,CAAC,IAAI,EAAE,SAAS,EAAC;AACzC,IAAI,SAAS,CAAC,IAAI;AAClB,MAAM,GAAG,CAAC,kBAAkB,CAAC,kBAAkB,IAAI,EAAE,CAAC;AACtD,MAAM,GAAG,CAAC,aAAa,CAAC,aAAa,IAAI,EAAE,CAAC;AAC5C,MAAK;AACL,IAAI,OAAO,GAAG;AACd,GAAG,EAAE,CAAC,IAAI,EAAE,OAAO,CAAC,EAAC;AAErB,EAAE,MAAM,KAAK,GAAG,WAAW,CAAC,GAAG,EAAC;AAEhC,EAAE,OAAO,EAAE,KAAK,EAAE,GAAG,EAAE;AACvB,CAAC;AAKM,SAAS,gBAAgB,CAAC,GAAG,EAAE,SAAS,EAAE,GAAG,IAAI,EAAE;AAC1D,EAAE,MAAM,SAAS,GAAG,GAAE;AACtB,EAAE,SAAS,CAAC,MAAM,MAAM,SAAS,CAAC,OAAO,CAAC,GAAG,IAAI,GAAG,EAAE,CAAC,EAAE,CAAC,GAAG,EAAE,SAAS,CAAC,EAAC;AAC1E,EAAE,SAAS,CAAC,MAAM;AAClB,IAAI;AACJ,MAAM;AACN,QAAQ,aAAa;AACrB,QAAQ,YAAY;AACpB,QAAQ,YAAY;AACpB,QAAQ,WAAW;AACnB,QAAQ,WAAW;AACnB,QAAQ,UAAU;AAClB,OAAO,CAAC,QAAQ,CAAC,SAAS,CAAC;AAC3B,MAAM;AACN,MAAM,SAAS,CAAC,IAAI,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC,GAAG,IAAI,CAAC,EAAC;AAC7C,KAAK,MAAM;AACX,MAAM,MAAM,IAAI,KAAK,CAAC,CAAC,eAAe,EAAE,SAAS,CAAC,CAAC,CAAC;AACpD,KAAK;AACL,GAAG,EAAE,CAAC,GAAG,EAAE,SAAS,CAAC,EAAC;AACtB;;;;"}